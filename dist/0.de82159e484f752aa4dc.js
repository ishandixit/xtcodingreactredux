webpackJsonp([0],{ASXU:function(e,t,a){var l=a("esWN");"string"==typeof l&&(l=[[e.i,l,""]]);var s={hmr:!0};s.transform=void 0,a("MTIv")(l,s),l.locals&&(e.exports=l.locals)},WcLr:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),d=a("GiK3"),m=l(d),u=a("odLB"),c=a("RH2O"),f=a("F8kA"),p=a("kYk7"),h=l(p);a("ASXU");var b=a("Oafi"),v=function(e){function t(e){s(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={data:[],formData:{firstName:"",lastName:"",mobile:"",email:"",role:"USER",password:""},row:{},authUser:{firstName:"",lastName:"",mobile:"",email:"",role:""},permissions:[],id_to_Role:{},role_to_id:{},currentUserIndex:""},a.formChange=a.formChange.bind(a),a.handleSubmit=a.handleSubmit.bind(a),a.getAllUsers=a.getAllUsers.bind(a),a.getAllRoles=a.getAllRoles.bind(a),a.selectRole=a.selectRole.bind(a),a.updateUserRole=a.updateUserRole.bind(a),a}return r(t,e),i(t,[{key:"componentDidMount",value:function(){var e=document.querySelectorAll(".modal");M.Modal.init(e,{dismissible:!1});var t=document.querySelectorAll("select");M.FormSelect.init(t,{}),M.updateTextFields(),this.props.user.token&&this.getAllRoles()}},{key:"getAllUsers",value:function(){var e=this;(0,b.fetchData)("/listing",{actionType:"user",token:this.props.user.token}).then(function(t){if(200==t.status){var a=t.data;a.map(function(e){e.role||(e.role={_id:"12345",name:"user"})}),e.setState({data:a})}else u.history.replace({state:n({},u.history.location.state,{alertMsg:t.msg})})})}},{key:"getAllRoles",value:function(){var e=this;(0,b.fetchData)("/accessControl/all",{actionType:"user",token:this.props.user.token}).then(function(t){if(200==t.outputCode){var a=t.response,l={},s={};a.map(function(e){l[e._id]=e.name,s[e.name]=e._id}),e.setState({id_to_Role:l,role_to_id:s}),e.setState({permissions:a},function(){var t=document.querySelectorAll("select");M.FormSelect.init(t,{}),e.getAllUsers()})}})}},{key:"takeAction",value:function(e,t){var a=e;this.setState({currentUserIndex:a.role._id}),a.lastName||(a.lastName=""),this.setState({authUser:a});var l=document.getElementById("authmodal");M.Modal.getInstance(l).open()}},{key:"formChange",value:function(e){var t=this.state.formData;t[e.target.name]=e.target.value,this.setState({formData:t})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.data,l=this.state.formData;(0,b.fetchData)("/signup",{firstName:l.firstName,lastName:l.lastName,email:l.email,password:l.password,mobile:l.mobile}).then(function(e){200==e.status?(a.push(t.state.formData),t.setState({data:a,formData:{firstName:"",lastName:"",mobile:"",email:"",role:"USER",password:""}})):u.history.replace({state:n({},u.history.location.state,{alertMsg:e.msg})})})}},{key:"selectRole",value:function(e){var t=e.target.value;if(""!=t){var a=this.state.authUser;a.role._id=t,this.setState({authUser:a})}}},{key:"updateUserRole",value:function(){var e=this.state.authUser,t=this.state.currentUserIndex;"12345"==t&&(t=null),(0,b.getData)("/accessControl/logic?actionType=change_user_role&user="+e._id+"&newRole="+e.role._id,this.props.user.token).then(function(e){}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.id_to_Role,a=[{Header:"S. No",width:100,Cell:function(e){return e.index+1}},{Header:"First Name",accessor:"firstName"},{Header:"Last Name",accessor:"lastName"},{Header:"Mobile",accessor:"mobile"},{Header:"Email",accessor:"email"},{Header:"Role",id:"roleid",accessor:function(e){return t[e.role._id]}},{Header:"Action",width:100,Cell:function(t){return m.default.createElement("a",{onClick:function(){return e.takeAction(t.original,t.index)},className:"red-text pointer fa-large"},m.default.createElement("i",{className:"fa fa-gear"}))}}],l=this.state.data;return m.default.createElement("div",{className:"userlist"},m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"col s12"},m.default.createElement("button",{"data-target":"formmodal",className:"btn modal-trigger"},"Add User"),m.default.createElement(h.default,{sortable:!1,filterable:!1,data:l,columns:a,defaultPageSize:100,minRows:1,showPagination:!1,className:"col m12 card z-depth-0",noDataText:m.default.createElement("span",null,"No found")}))),m.default.createElement("div",{id:"formmodal",className:"modal add-user-modal"},m.default.createElement("div",{className:"modal-head"},m.default.createElement("div",null,"Add New User")),m.default.createElement("div",{className:"modal-content"},m.default.createElement("div",{className:"row",style:{marginBottom:0}},m.default.createElement("form",{className:"col s12",onChange:this.formChange,onSubmit:this.handleSubmit},m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"input-field col s6"},m.default.createElement("input",{id:"first_name",name:"firstName",value:this.state.formData.firstName,type:"text",className:"validate"}),m.default.createElement("label",{for:"first_name"},"First Name")),m.default.createElement("div",{className:"input-field col s6"},m.default.createElement("input",{id:"last_name",name:"lastName",value:this.state.formData.lastName,type:"text",className:"validate"}),m.default.createElement("label",{for:"last_name"},"Last Name"))),m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"input-field col m6 s12"},m.default.createElement("input",{id:"email",name:"email",value:this.state.formData.email,type:"email",className:"validate"}),m.default.createElement("label",{for:"email"},"Email")),m.default.createElement("div",{className:"input-field col m6 s12"},m.default.createElement("input",{id:"mobile",name:"mobile",value:this.state.formData.mobile,type:"number",className:"validate"}),m.default.createElement("label",{for:"mobile"},"Mobile"))),m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"input-field col s12"},m.default.createElement("input",{id:"password",name:"password",value:this.state.formData.password,type:"password",className:"validate"}),m.default.createElement("label",{for:"password"},"Password"))),m.default.createElement("button",{type:"submit",className:"modal-close waves-effect waves-green btn btn-small"},"Add"),m.default.createElement("button",{className:"modal-close waves-effect red btn btn-small",style:{marginLeft:10}},"Cancel"))))),m.default.createElement("div",{id:"authmodal",className:"modal authmodal"},m.default.createElement("div",{className:"modal-head"},m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"col m4 s12"},this.state.authUser.firstName+" "+this.state.authUser.lastName),m.default.createElement("div",{className:"col m4 s12"},this.state.authUser.email),m.default.createElement("div",{className:"col m4 s12"},this.state.authUser.mobile))),m.default.createElement("div",{className:"modal-content"},m.default.createElement("div",{className:"row",style:{paddingTop:20}},m.default.createElement("div",{className:"col s6"},m.default.createElement("select",{name:"role",value:this.state.authUser.role._id,className:"browser-default",onChange:function(t){return e.selectRole(t)}},m.default.createElement("option",{value:"",selected:!0},"Choose role"),this.state.permissions.map(function(e,t){return m.default.createElement("option",{value:e._id,key:t},e.name)}))),m.default.createElement("div",{className:"col s12",style:{marginTop:20}},m.default.createElement("button",{onClick:function(t){return e.updateUserRole()},className:"modal-close waves-effect waves-green btn"},"Update"),m.default.createElement("button",{className:"modal-close waves-effect red btn",style:{marginLeft:10}},"Cancel"))))))}}]),t}(d.Component),g=function(e){return{user:e.user}};t.default=(0,f.withRouter)((0,c.connect)(g,null)(v))},esWN:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".userlist .add-user-modal{width:62%!important;top:5%!important;border-radius:10px;background-image:linear-gradient(141deg,#9fb8ad,rgba(21,56,60,.619608) 51%,rgba(34,110,138,.768627) 75%)}.userlist .add-user-modal .modal-head{position:sticky;background:#d3d3d34d;top:0;padding:5px;padding-left:38px;display:flex;z-index:1;color:#000}.userlist .add-user-modal .modal-content{padding-top:0}.userlist .add-user-modal .modal-content .row,.userlist .add-user-modal .modal-content .row .input-field{margin-bottom:0}.userlist .add-user-modal .modal-content .row .input-field .active,.userlist .add-user-modal .modal-content .row .input-field label{color:#fff}.userlist .add-user-modal .modal-content select{height:2rem}.userlist .add-user-modal .modal-content input[type=email],.userlist .add-user-modal .modal-content input[type=number],.userlist .add-user-modal .modal-content input[type=password]:not(.browser-default),.userlist .add-user-modal .modal-content input[type=text]{border-bottom:1px solid #fff}.userlist .authmodal{width:62%!important;top:5%!important;border-radius:10px;background-image:linear-gradient(141deg,#9fb8ad,rgba(21,56,60,.619608) 51%,rgba(34,110,138,.768627) 75%)}.userlist .authmodal .modal-head{position:sticky;background:#d3d3d34d;top:0;padding:5px;z-index:1;color:#000}.userlist .authmodal .modal-head .row{margin-bottom:0}.userlist .authmodal .modal-content{padding-top:0}.userlist .authmodal .modal-content .row,.userlist .authmodal .modal-content .row .input-field{margin-bottom:0}.userlist .authmodal .modal-content .row .input-field .active,.userlist .authmodal .modal-content .row .input-field label{color:#fff}.userlist .authmodal .modal-content select{height:2rem}.userlist .authmodal .modal-content input[type=email],.userlist .authmodal .modal-content input[type=number],.userlist .authmodal .modal-content input[type=password]:not(.browser-default),.userlist .authmodal .modal-content input[type=text]{border-bottom:1px solid #fff}",""])}});