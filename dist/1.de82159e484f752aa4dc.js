webpackJsonp([1],{Oj8M:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=a("GiK3"),u=n(c),m=(a("cgmn"),a("odLB")),f=a("F8kA"),p=a("RH2O"),h=a("kYk7"),g=n(h);a("hD9w");var b=a("Oafi"),y=function(e){function t(e){l(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={data:[],role_name:"",row:{},showpermission:!1,permission:{},changedPermission:{},showUpdatePermission:!1,editingrole:""},a.formChange=a.formChange.bind(a),a.handleSubmit=a.handleSubmit.bind(a),a.getAllRoles=a.getAllRoles.bind(a),a.handlePermissionClick=a.handlePermissionClick.bind(a),a.deleteRole=a.deleteRole.bind(a),a.updatePermissions=a.updatePermissions.bind(a),a}return r(t,e),d(t,[{key:"componentDidMount",value:function(){var e=document.querySelectorAll(".modal");M.Modal.init(e,{});var t=document.querySelectorAll("select");M.FormSelect.init(t,{}),M.updateTextFields(),this.props.user.token&&this.getAllRoles()}},{key:"getAllRoles",value:function(){var e=this;(0,b.fetchData)("/accessControl/all",{actionType:"user",token:this.props.user.token}).then(function(t){if(200==t.outputCode){var a=t.response;e.setState({data:a})}else m.history.replace({state:i({},m.history.location.state,{alertMsg:body.msg})})})}},{key:"takeAction",value:function(e,t){var a=e.permission;this.setState({showpermission:!0}),this.setState({permission:a,editingrole:e.name})}},{key:"formChange",value:function(e){var t=this.state.role_name;t=e.target.value,this.setState({role_name:t})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.role_name;if(0==a.trim().length)return void M.toast({html:"Enter a Role name",classes:"red"});(0,b.fetchData)("/accessControl",{name:a,token:this.props.user.token}).then(function(e){200==e.outputCode&&(M.toast({html:"Role Added",classes:"green"}),t.getAllRoles())}).catch(function(e){alert(e.message)})}},{key:"handlePermissionClick",value:function(e,t,a){var n=this.state.permission,l=this.state.changedPermission;void 0==t?(n[e].read=!n[e].read,l[e]=n[e],this.setState({showUpdatePermission:!0})):(n[e].subModules[t][a]=!n[e].subModules[t][a],l[e]=n[e]),this.setState({showUpdatePermission:!0}),this.setState({permission:n,changedPermission:l})}},{key:"deleteRole",value:function(e,t){var a=this,n={};n.token=this.props.user.token,(0,b.deleteData)("/accessControl/"+e._id,n).then(function(e){200==e.outputCode&&(M.toast({html:"Role removed",classes:"green"}),a.getAllRoles())}).catch(function(e){alert(e.message)})}},{key:"updatePermissions",value:function(){var e=this.state.changedPermission;(0,b.updateData)("/permission/"+this.state.permission._id,i({},e)).then(function(e){M.toast({html:e.message,classes:"rounded green"})}).catch(function(e){M.toast({html:"Role Update failed",classes:"rounded red"})})}},{key:"render",value:function(){var e=this,t=[{Header:"S. No",width:100,Cell:function(e){return e.index+1}},{Header:"Role Name",accessor:"name"},{Header:"Users Count",Cell:function(e){return e.original.user.length}},{Header:"Delete",width:100,Cell:function(t){return u.default.createElement("a",{onClick:function(){return e.deleteRole(t.original,t.index)},className:"red-text pointer fa-large"},u.default.createElement("i",{className:"fa fa-trash"}))}},{Header:"View",width:100,Cell:function(t){return u.default.createElement("a",{onClick:function(){return e.takeAction(t.original,t.index)},className:"red-text pointer fa-large"},u.default.createElement("i",{className:"fa fa-gear"}))}}],a=this.state.data,n=this.state.permission,l=this.state.showpermission,o=this.state.editingrole;return u.default.createElement("div",{className:"rolemanager"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col s12"},u.default.createElement("button",{"data-target":"formmodal",className:"btn modal-trigger"},"Add New Role"),u.default.createElement(g.default,{sortable:!1,filterable:!1,data:a,columns:t,defaultPageSize:100,minRows:1,showPagination:!1,className:"col m12 card z-depth-0",noDataText:u.default.createElement("span",null,"No found")})),l&&n&&Object.keys(n).length>0&&u.default.createElement("div",{className:"col s12"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col s11 role-name"},o," Permissions"),u.default.createElement("div",{className:"col s1"},this.state.showUpdatePermission&&u.default.createElement("button",{className:"waves-effect waves-green btn",onClick:function(t){return e.updatePermissions()}},"Update"))),Object.keys(n).map(function(t){return"object"==s(n[t])&&n[t].read&&n[t].subModules?u.default.createElement(u.default.Fragment,null," ",u.default.createElement("label",null," ",u.default.createElement("input",{onClick:function(a){return e.handlePermissionClick(t)},type:"checkbox",className:"filled-in",checked:n[t].read?"checked":""}),u.default.createElement("span",{className:"module-name"},t)),u.default.createElement("div",{className:"row flex-container"},n[t].read&&n[t].subModules&&Object.keys(n[t].subModules).map(function(a){if("_id"!=a&&"updatedAt"!=a&&"createdAt"!=a&&"role"!=a)return u.default.createElement("div",{className:"sub-module-name"},a,Object.keys(n[t].subModules[a]).map(function(l){if("_id"!=l&&"updatedAt"!=l&&"createdAt"!=l&&"role"!=l)return u.default.createElement("span",null,u.default.createElement("label",null,u.default.createElement("input",{onClick:function(n){return e.handlePermissionClick(t,a,l)},type:"checkbox",className:"filled-in",checked:n[t].subModules[a][l]?"checked":""}),u.default.createElement("span",null,l)))}))}))," "):"object"!=s(n[t])||n[t].read?void 0:u.default.createElement(u.default.Fragment,null," ",u.default.createElement("label",null," ",u.default.createElement("input",{onClick:function(a){return e.handlePermissionClick(t)},type:"checkbox",className:"filled-in",checked:n[t].read?"checked":""}),u.default.createElement("span",{className:"module-name"},t)))}))),u.default.createElement("div",{id:"formmodal",className:"modal add-role"},u.default.createElement("div",{className:"modal-head"},u.default.createElement("div",null,"Add New Role")),u.default.createElement("div",{className:"modal-content"},u.default.createElement("div",{className:"row",style:{marginBottom:0}},u.default.createElement("form",{className:"col s12",onChange:this.formChange,onSubmit:this.handleSubmit},u.default.createElement("div",{className:"input-field col s6",style:{marginTop:0,marginBottom:0}},u.default.createElement("span",{style:{color:"#fff"}},"Role Name"),u.default.createElement("input",{id:"role_name",placeholder:"Role name",name:"role_name",value:this.state.role_name,type:"text",className:"validate"})),u.default.createElement("button",{type:"submit",className:"modal-close waves-effect waves-green btn"},"Add"))))))}}]),t}(c.Component),v=function(e){return{user:e.user}};t.default=(0,f.withRouter)((0,p.connect)(v,null)(y))},YY0O:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".rolemanager .role-name{text-transform:capitalize;font-weight:600;padding-left:27px}.rolemanager .module-name{font-weight:700;font-size:16px;margin-left:15px;text-transform:capitalize}.rolemanager .sub-module-name{margin-left:25px;font-size:14px;font-weight:700;padding:5px;text-transform:capitalize;display:flex;flex-direction:column}.rolemanager .flex-container{display:flex;flex-wrap:wrap}.rolemanager .flex-container:nth-of-type(odd){background-color:#fff}.rolemanager .flex-container:nth-of-type(2n){background-color:#f7f8fa}.rolemanager .add-role{width:30%!important;top:5%!important;border-radius:10px;background-image:linear-gradient(141deg,#9fb8ad,rgba(21,56,60,.619608) 51%,rgba(34,110,138,.768627) 75%)}.rolemanager .add-role .modal-head{position:sticky;background:#d3d3d34d;top:0;padding:5px;padding-left:38px;display:flex;z-index:1;color:#000}.rolemanager .add-role .modal-content{padding-top:10px}.rolemanager .add-role .modal-content input[type=text]:not(.browser-default){height:2rem;font-size:14px;border-bottom:1px solid #fff}.rolemanager .add-role .modal-content .input-field .active,.rolemanager .add-role .modal-content .input-field label{color:#fff}",""])},hD9w:function(e,t,a){var n=a("YY0O");"string"==typeof n&&(n=[[e.i,n,""]]);var l={hmr:!0};l.transform=void 0,a("MTIv")(n,l),n.locals&&(e.exports=n.locals)}});